{% import 'icons.html' as icon %}
{% import 'components.html' as component %}


<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WiZ Light'er</title>
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <link rel="shortcut icon" href="{{ url_for('static', filename='favicon/favicon.ico') }}">
  <link rel="apple-touch-icon" href="{{ url_for('static', filename='favicon/apple-touch-icon.png') }}">
  <link href="{{ url_for('static', filename='output.css') }}" rel="stylesheet">
  <script src="{{ url_for('static', filename='htmx.min.js') }}"></script> <!-- HTMX v2.0.7 -->
</head>

<body>
  <form x-data="{ tab: 'tab-temp' }" hx-post="/" hx-trigger="input changed delay:500ms" hx-swap="none"
    class="relative font-lexend-deca h-dvh w-screen bg-stone-900 overflow-hidden lg:w-96 lg:mx-auto" action="">

    <!-- HEADER -->
    <div class="flex flex-col w-full bg-sky-800 p-2">
      <div class="flex gap-2 items-center">
        {{ icon.bulb() }}
        <select name="id" id="bulbid" class="border-2 rouded-lg my-3 p-2 w-full text-white" hx-get="/"
          hx-trigger="changed delay:500ms">
          {% for bulb in bulbs %}
          <option value="{{ bulb.id }}">{{ bulb.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <!-- BODY -->
    <div class="w-full p-2 py-5">

      <!-- ðŸŒ¡ Temperature Tab -->
      <div x-show="tab === 'tab-temp'">
        {{ component.slider(id='temp', name='temperature', icon=icon.temperature(), min=2200, max=6200, value=3000) }}
      </div>

      <!-- ðŸ–¼ Scene Tab -->
      <div x-show="tab === 'tab-scene'" class="relative">
        <div x-data="{ sceneTab: 'tab-static' }" class="space-y-4">
          <!-- Radio buttons -->
          <div role="radiogroup" aria-label="Choose tab" class="flex justify-around">
            {{ component.tab(id='scene-1', name='sceneTab', value='tab-static', icon='Static') }}
            {{ component.tab(id='scene-2', name='sceneTab', value='tab-dynamic', icon='Dynamics') }}
            {{ component.tab(id='scene-3', name='sceneTab', value='tab-miscellaneous', icon='Miscellaneous') }}
          </div>

          <!-- Content -->
          <div x-show="sceneTab === 'tab-static'" class="p-4rounded">
            <div class="grid grid-cols-4 text-white text-center gap-2 text-sm place-items-center">
              {{ component.option('mode-0', 'defaultMode', '6', 'Cozy') }}
              {{ component.option('mode-1', 'defaultMode', '11', 'Warm White') }}
              {{ component.option('mode-2', 'defaultMode', '12', 'Daylight') }}
              {{ component.option('mode-3', 'defaultMode', '13', 'Cool White') }}
              {{ component.option('mode-4', 'defaultMode', '14', 'Night Light') }}
              {{ component.option('mode-5', 'defaultMode', '15', 'Focus') }}
              {{ component.option('mode-6', 'defaultMode', '16', 'Relax') }}
              {{ component.option('mode-7', 'defaultMode', '17', 'True Colors') }}
              {{ component.option('mode-8', 'defaultMode', '18', 'TV Time') }}
              {{ component.option('mode-9', 'defaultMode', '19', 'Plant Growth') }}
            </div>
          </div>

          <div x-show="sceneTab === 'tab-dynamic'" class="p-4 rounded">
            <div class="grid grid-cols-4 text-white text-center gap-2 text-sm place-items-center">
              {{ component.option('mode-10', 'defaultMode', '1', 'Ocean') }}
              {{ component.option('mode-11', 'defaultMode', '2', 'Romance') }}
              {{ component.option('mode-12', 'defaultMode', '3', 'Sunset') }}
              {{ component.option('mode-13', 'defaultMode', '4', 'Party') }}
              {{ component.option('mode-14', 'defaultMode', '5', 'Fireplace') }}
              {{ component.option('mode-15', 'defaultMode', '7', 'Forest') }}
              {{ component.option('mode-16', 'defaultMode', '8', 'Pastel Colors') }}
              {{ component.option('mode-17', 'defaultMode', '20', 'Spring') }}
              {{ component.option('mode-18', 'defaultMode', '21', 'Summer') }}
              {{ component.option('mode-19', 'defaultMode', '22', 'Fall') }}
              {{ component.option('mode-20', 'defaultMode', '23', 'Deepdive') }}
              {{ component.option('mode-21', 'defaultMode', '24', 'Jungle') }}
              {{ component.option('mode-22', 'defaultMode', '25', 'Mojito') }}
              {{ component.option('mode-23', 'defaultMode', '26', 'Club') }}
              {{ component.option('mode-24', 'defaultMode', '27', 'Christmas') }}
              {{ component.option('mode-25', 'defaultMode', '28', 'Halloween') }}
              {{ component.option('mode-26', 'defaultMode', '29', 'Candlelight') }}
              {{ component.option('mode-27', 'defaultMode', '30', 'Golden white') }}
              {{ component.option('mode-28', 'defaultMode', '31', 'Pulse') }}
              {{ component.option('mode-29', 'defaultMode', '32', 'Steampunk') }}
            </div>
            <div class="my-2">
              {{ component.slider(id='sped', name='speed', icon=icon.speed(), min=10, max=100, value=20) }}
            </div>
          </div>

          <div x-show="sceneTab === 'tab-miscellaneous'" class="p-4 rounded">
            <div class="grid grid-cols-4 text-white text-center gap-2 text-sm place-items-center">
              {{ component.option('mode-30', 'defaultMode', '9', 'Wake Up') }}
              {{ component.option('mode-31', 'defaultMode', '10', 'Bedtime') }}
              {{ component.option('mode-32', 'defaultMode', '1000', 'Rhythm') }}
            </div>
          </div>
        </div>
      </div>

      <!-- ðŸŽ¨ RGB Tab -->
      <div x-show="tab === 'tab-rgb'"></div>
      <div x-show="tab === 'tab-user-bulb'"></div>

    </div>

    <!-- FOOTER -->
    <div class="bottom-0 absolute w-full bg-sky-800">
      <div role="radiogroup" aria-label="Choose tab" class="flex justify-around">
        {{ component.tab(id='tab-1', name='tab', value='tab-temp', icon=icon.temperature()) }}
        {{ component.tab(id='tab-2', name='tab', value='tab-scene', icon=icon.scene()) }}
        {{ component.tab(id='tab-3', name='tab', value='tab-rgb', icon=icon.rgb()) }}
        {{ component.tab(id='tab-4', name='tab', value='tab-user-bulb', icon=icon.userBulb()) }}
      </div>
      <div class="p-2 my-2">
        {{ component.slider(id='bright', name='brightness', icon=icon.brightness(), min=10, max=100, value=40) }}
      </div>

    </div>
  </form>

  <!-- <script src="{{ url_for('static', filename='service-worker.js') }}"></script> -->
  <script src="//unpkg.com/alpinejs" defer></script>

  <script>
    function sliderBox(id, name, min, max, initial) {
      return {
        val: initial,
        min,
        max,
        name,
        get percent() {
          // special case for temperature â†’ remap range
          if (name === 'temperature' || id.startsWith('temp')) {
            return ((this.val - 2200) * (100 - 0)) / (6200 - 2200) + 0;
          }
          // otherwise normal percentage
          return this.val;
        }
      }
    }
  </script>
</body>

</html>